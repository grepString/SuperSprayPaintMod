print("[Example Script] Loaded.")

local UEHelpers = require("UEHelpers")

RegisterKeyBind(Key.F5, function()
    print("F5 key detected. Proceeding with PlayerController access")

    local pc = UEHelpers:GetPlayerController()
    if not pc then
        print("No PlayerController found.")
        return false
    end

    local widgetClass = StaticFindObject("/Game/UI/ItemSpawnerMenu/ItemSpawnerMenu.ItemSpawnerMenu_C")
    if not widgetClass then
        print("Widget is missing.")
        return false
    end

    local world = pc:GetWorld()
    if not world then
        print("No valid world.")
        return false
    end

    local exampleWidget = StaticConstructObject(widgetClass, world)
    if exampleWidget then
        if exampleWidget.Construct then
            exampleWidget:Construct()
        end
        exampleWidget:SetVisibility(0)
        exampleWidget:AddToViewport(0)

        -- Lock mouse and focus to the widget
        local inputMode = UEHelpers:NewStruct("FInputModeUIOnly")
        inputMode:SetWidgetToFocus(exampleWidget)
        inputMode:SetLockMouseToViewportBehavior(3)  -- 1 = DoNotLock, 2 = LockAlways, 3 = LockOnCapture
        pc:SetInputMode(inputMode)
        pc.bShowMouseCursor = true

        print("Example UI opened safely and mouse locked.")
    else
        print("Widget failed.")
    end

    return false 
end)